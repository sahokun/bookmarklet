javascript:(async function(){function h(){var a=document.querySelector("div[data-v-2819963c].ammSwapModal__balance").querySelectorAll("p");a=Array.from(a).find(b=>b.textContent.includes("\u6240\u6301\u91cf")).textContent.match(/[\d,]+(\.\d+)?/);if(!a)throw Error("\u6570\u5024\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002");a=parseFloat(a[0].replace(/,/g,""));console.log("\u6240\u6301\u91cf:",a);return a}function k(a){const b=document.querySelector(".ammSwapModal__balance"),c=document.createElement("p");
c.textContent=`\u6700\u9069\u58f2\u5374\u91cf : ${a}`;c.classList.add("optimal-seller-amount");(a=b.querySelector("p.optimal-seller-amount"))?a.textContent=c.textContent:b.prepend(c)}function l(){var a=document.querySelector(".ammSwapModal__token");if(!a)throw Error("\u7d20\u6750\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002");var b=a.querySelector("img").src.match(/\/(\d{3})\./);b=b?b[1]:null;a=a.querySelector("p").textContent;console.log("\u7d20\u6750ID:",b,"\u7d20\u6750\u540d:",
a);return{materialId:parseInt(b),materialName:a}}async function m(a,b){console.log("\u7d20\u6750ID",a,"\u5e0c\u671b\u58f2\u5374\u7d20\u6750\u91cf:",b);a:{for(c of n.tokenPricesMap)if(c[0]===a){var c=c[1].seller.price;break a}c=null}console.log("\u73fe\u5728\u4fa1\u683c:",c);c=Math.floor((Math.floor(c*b)-1)/c*100)/100;0>c&&(c=0);console.log("\u6982\u7b97\u4e0b\u9650\u7d20\u6750\u8cfc\u5165\u91cf:",c);var e=(await $nuxt.$store.$laboratoryService.estimateSaleAmount(a,1E3*b)).amount;if(0===e)throw Error("1GUM\u306b\u6e80\u305f\u306a\u3044\u305f\u3081\u58f2\u5374\u3067\u304d\u307e\u305b\u3093");
console.log("\u76ee\u6a19\u4fa1\u683c:",e);for(var g=0;;){console.log("\u30eb\u30fc\u30d7\u56de\u6570:",g+1,"\u4e0a\u9650:",b,"\u4e0b\u9650:",c,"\u76ee\u6a19:",e);var d=Math.ceil((b+c)/2*100)/100,f=(await $nuxt.$store.$laboratoryService.estimateSaleAmount(a,1E3*d)).amount;console.log("\u4e2d\u9593\u5024:",d,"\u4e2d\u9593\u5024\u306e\u4fa1\u683c:",f);f===e?(b=d,console.log(`\u4e2d\u9593\u5024\u306e\u4fa1\u683c\u304c\u76ee\u6a19\u4fa1\u683c\u3068\u540c\u3058\u306a\u306e\u3067\u4e0a\u9650\u3092\u4e0b\u3052\u307e\u3059\u3002\u4e0a\u9650: ${d}`)):
(c=d,console.log(`\u4e2d\u9593\u5024\u306e\u4fa1\u683c\u304c\u76ee\u6a19\u4fa1\u683c\u3088\u308a\u4f4e\u3044\u306e\u3067\u4e0b\u9650\u3092\u4e0a\u3052\u307e\u3059\u3002\u4e0b\u9650: ${d}`));d=Math.ceil(1E3*(.001*d+.0100000001))/1E3;f=Math.ceil(1E3*Math.abs(b-c))/1E3;console.log(`\u8a08\u7b97\u91cf\u5dee\u5206: ${f}`,`\u8a31\u5bb9\u8aa4\u5dee(${.1}%): ${d}`);if(f<=d){console.log("\u8a31\u5bb9\u8aa4\u5dee\u5185\u306b\u306a\u3063\u305f\u305f\u3081\u8a08\u7b97\u7d42\u4e86");break}if(9===g){alert("\u30eb\u30fc\u30d7\u56de\u6570\u4e0a\u9650\u3092\u8d85\u3048\u307e\u3057\u305f\u3002");
break}g++}console.log("\u58f2\u5374\u53ef\u80fd\u91cf:",b);return b}const n=await $nuxt.$store.$laboratoryService.getAllTokenPrices();try{const a=l(),b=prompt(`${a.materialName} \u5e0c\u671b\u58f2\u5374\u91cf\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044:`,h());if(isNaN(b))throw Error("isNaN");const c=parseFloat(b);let e=await m(a.materialId,c);k(e);alert(`\u6700\u9069\u306a\u58f2\u5374\u91cf: ${e}`)}catch(a){console.log(a),alert(`\u6700\u9069\u306a\u58f2\u5374\u91cf\u7b97\u51fa\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\n\n${a.toString()}`)}})();
